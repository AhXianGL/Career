# 2023/1/19

## 年终随笔

## 现实

## 项目经历

1. 影像数据生产任务监控、分发、管理系统-DMES(Data MES,数据生产MES系统)的重构和更新.
   项目周期即贡献:
   第一阶段:代码架构调整。
   参与前端的基础设施的技术选型,参与新版本前端代码架构设计
   第二阶段:业务逻辑实现与更新。
   按照新版本代码架构重新封装API层代码,规范组件名称,将组件式路由调整为递归函数生成的配置式路由。
   将旧版本的代码填充至新版本架构中。
   第三阶段测试与交付:
   修复Bug, 更新交互, 优化性能

   项目难点:

   1. 权限系统设计即权限系统前后端耦合:
      > 前端建立Purview权限的数据模型(类),用户首次登录时将用户的总权限值,与后端的权限码保持一致,在需要权限控制的交互/路由节点,增加权限控制,限制用户的UI和交互。
      > 单层权限无法满足需求后设计了多层权限,提出了"域"的概念,即将用户当前所在的路由位置映射为"系统"、"团队"、"项目"三个系统级别,不同域内权限列表不同,用户在三级域中有不同的权限系统,通过权限系统的分级实现更细致的权限控制。
      > 前端的配合手段就是利用sessionStorage存放用户当前的域,用户所在域变动时, 更新域, 发送请求时将域放入请求头, 与后端相配合

   2. 根据后端的JSON生成表单,动态的表单项,动态的校验规则:
      > 二次封装Form.Item组件,根据JSON递归生成Form.Item,

2. 遥感影像轻型检索系统
   遥感影像检索、浏览、管理系统
   项目周期即贡献:
   技术选型: 脚手架:customize-cra + react-app-rewired + cra 
            地图框架:leaflet
            UI框架: antd react
            状态管理工具: dva
   全程独立开发,封装leaflet图层组件,完全由数据驱动的图层组件,原理:灵活运用react Class Component
   的生命周期,通过组件组合的方式来完成图层加载这一副作用和react状态的同步
   项目难点:
   1. 遥感影像数据模型(业务模型),中类型tif数据或者其他传统遥感数据中的元数据(metaData)
   的概念的理解。
   2. 地图库如Leaflet和react库配合使用时, 对"副作用" ,生命周期函数, 以及RFC hooks的理解有一定的要求。
   3. google:xyz形式的地图服务,OGC标准的wmts,wms,wfs地图服务添加图层之前的预处理:要根据后端返回的元信息,来判断这个地理数据是以什么样的地图服务来添加到图层中,解析wmts,wms地图服务
3. 地理大数据仓库管理平台,负责数据浏览模块。
   项目周期即贡献:

### 未完成

Flux架构到redux实践的历史沿革,
深入理解前端工程化
深入理解前端模块化(history and why and future)
js设计模式

### Inspiration

在回忆项目经历的时候有一种感觉: 作为产品研发团队的前端开发, 对于系统和业务产生思考之后,不禁会产生对于系统设计的疑问:

1. "系统设计真的合理吗,扩展性强吗?"

2. "这样的系统设计下,前端的每次扩展或者更新,改动是否过于困难",
但是团队的重心往往都在后端,后端团队对业务模型进行抽象后提供数据操作接口,前端来实现与业务逻辑耦合的
交互逻辑,这样往往产生这样一种开发体验: 前端已经做好了一个版本,建立了一些前端自己使用的数据模型和数
据流,但是"与业务逻辑耦合的交互逻辑"实现后,整个小组发现这样的设计存在种种缺陷,不得不改动设计,但是系
统设计变动对后端代码结构的"破坏"应该远远没有其对前端数据模型和数据流方案的"破坏"来的严重。
造成这种"前端代码迭代困难,维护困难"的根本原因我认为就是:
   * 前端的组件的实现与业务逻辑解耦没有做好,
   交互决定了数据流和组件组合方式。组件与业务逻辑和数据模型进行了绑定,每变动一次,都对组件做一次小的摧毁,最终状态混乱,数据流出现漏洞,维护困难,因为开发者无法弄清楚"当初这个组件/页面的数据流为什么这样设计,为什么这个数据流与现在的系统设计格格不入"。
   * 傻卵设计不动脑子根本没有什么产品或者系统设计的思想,只会抄和搬,把系统设计的工作做成像打螺丝一样的重复组合劳动

怎么解决前端迭代过程中的问题,怎么解决组件重构问题带来的负担,决定了前端工作的痛苦程度。

也有可能 **我现在公司的领导喜欢插手系统设计,总是做好了之后要对系统设计的结构进行调整,而不是增量或者缩量改动,是他喵的直接要重新设计一些功能和业务逻辑,真傻卵,伟大的产品绝对不是诞生在这种人手中**