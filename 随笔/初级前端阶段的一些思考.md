### 2022/11/17

恍惚间已经工作五个月了
1. 参与heydat.web重构
2. 合作基于heydat.web-IPM定制版开发
3. 独立完成轻型影像检索系统的前端开发

此外维护数个项目,此过程中对公司代码的阅读与修补之后,萌生了一些工程(Project)层面的想法,在此处记录.

> 我们会书写文字但是不一定能写出好的作品.
> 我们会编写代码但是不一定能写出好的程序,做出好的产品.
#### 背景概述
入职伊始, 本以为会有前端的前辈一起合作, 可惜唯一的前端同事在我入职一周后离职了, 带领我'入门'的是一位经验丰富的后端'老'师傅(https://github.com/kobeyk), 两周时间我完成了react的学习和redux相关的生态的工具的学习, 勉强完成了公司的任务单考试。
第三周, 组里启动某一产品的前端代码重构计划, 为后续产品面向用户需求的定制转化做准备。并且领导将重构与某模块的性能优化作为我的转正的考核任务, 心中很是不安,冷静思考之后觉知是个不错的机会.
> 只有布甲和短剑的我, 应该如何跟随大佬'屠龙'呢？

#### 阅读同事/前同事的代码
阅读他人的代码给我带来的感受与拆盲盒给我的感受很相似. 可能会看到很绝妙的逻辑实现(各种设计模式`单例,观察者,策略模式等等`或者是少量的 hacks`调用框架源码中未暴露的函数解决某些特定问题(这些问题同时也是当初反模式地使用框架而造成的)` ); 很糟糕的组件结构,很糟糕的布局实现方式,很糟糕的编码风格(或者完全无'风格'的流式编码,想怎么写就怎么写), 可以透过代码看到编写者的工作心情(态度)甚至是性格和思想. 
但是不管怎样, 工作是要向前推进的, 唯一能做的就是时刻观察自己的情绪, 控制住自己的情绪, 吸收别人代码中的精华, 理解别人代码的杂乱(也许当初是需求的频繁变动或者工作环境不好呢?), 发现之前留下的代码中的反模式, 提醒自己今后开发过程中不要犯类似的错误, 抱着这样的心态, 我的工作渐渐不那么痛苦了, 而且代码能力飞速的进步.
#### 重构
重构项目(前端)是一个很困难的工作, 困难程度取决于对重构结果的期望.
我们希望重构后的代码架构更加清晰, 模块更加解耦, 数据模型和业务模型更加满足产品需求的抽象, 从而维护成本显著降低.然后重构的效果才能在产品层面显现: 产品的可扩展性增强,维护且维护的人力/时间成本降低.
以react + react-router-V5 + dva + webpack5为例,实践过程的工作流是这样的.

重构工作分版本进行
准备: 了解需求, 从路由触发, 探索web应用的整体结构.
1. Refactor-alpha基础设施(业务逻辑代码的外壳)的'翻新':
   1. 分析前端路由, 架构调整,如文件目录结构规整, 将路由与组件"解耦", 改为配置型的集中管理,如 React-RouterV5 有递归创建路由的实现方式, React-RouterV6有配置式路由(ref: https://github.com/remix-run/react-router/tree/dev/examples/route-objects).
   2. 增强组件命名语义化(文件重命名, 重整混乱的代码目录结构)
   3. 小组分模块合作, 将旧的代码搬到新的框架(重构后的文件结构)中.
2. Refactor-beta - 新瓶装旧酒 旧的业务逻辑、组件代码装填到新的文件结构中
   1. 小组分模块搬运、填充代码, 添加大量的注释的同时增强小组成员对业务逻辑的理解。
   2. 实施架构填充, 按照架构填充代码
3. Refactor-release - 反复测试, 修复, 最终发布

#### 产品到项目的定制化
##### 产品维护
##### 基于产品定制化项目

#### 第一次独立完成项目(完整的一次务逻辑实现)